{
    "version": "2.0.0",
    "tasks": [
        // ========================================================================
        // Configure Tasks (using CMake Presets)
        // ========================================================================
        {
            "label": "Configure Debug",
            "type": "shell",
            "windows": {
                "command": "cmake",
                "args": [
                    "--preset",
                    "windows-msys-debug"
                ]
            },
            "linux": {
                "command": "cmake",
                "args": [
                    "--preset",
                    "linux-debug"
                ]
            },
            "osx": {
                "command": "cmake",
                "args": [
                    "--preset",
                    "macos-debug"
                ]
            },
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            }
        },
        {
            "label": "Configure Release",
            "type": "shell",
            "windows": {
                "command": "cmake",
                "args": [
                    "--preset",
                    "windows-msys-release"
                ]
            },
            "linux": {
                "command": "cmake",
                "args": [
                    "--preset",
                    "linux-release"
                ]
            },
            "osx": {
                "command": "cmake",
                "args": [
                    "--preset",
                    "macos-release"
                ]
            },
            "problemMatcher": [],
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            }
        },

        // ========================================================================
        // Build Tasks (using CMake Presets)
        // ========================================================================
        {
            "label": "Build Debug",
            "type": "shell",
            "windows": {
                "command": "cmake",
                "args": [
                    "--build",
                    "--preset",
                    "windows-msys-debug-build"
                ]
            },
            "linux": {
                "command": "cmake",
                "args": [
                    "--build",
                    "--preset",
                    "linux-debug-build"
                ]
            },
            "osx": {
                "command": "cmake",
                "args": [
                    "--build",
                    "--preset",
                    "macos-debug-build"
                ]
            },
            "dependsOn": [
                "Configure Debug"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "problemMatcher": [
                "$gcc"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            }
        },
        {
            "label": "Build Release",
            "type": "shell",
            "windows": {
                "command": "cmake",
                "args": [
                    "--build",
                    "--preset",
                    "windows-msys-release-build"
                ]
            },
            "linux": {
                "command": "cmake",
                "args": [
                    "--build",
                    "--preset",
                    "linux-release-build"
                ]
            },
            "osx": {
                "command": "cmake",
                "args": [
                    "--build",
                    "--preset",
                    "macos-release-build"
                ]
            },
            "dependsOn": [
                "Configure Release"
            ],
            "group": "build",
            "problemMatcher": [
                "$gcc"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            }
        },

        // ========================================================================
        // Compatibility Alias Tasks
        // ========================================================================
        {
            "label": "Build release with CMake",
            "type": "shell",
            "dependsOn": [
                "Build Release"
            ],
            "command": "echo",
            "args": [
                "Build Release completed"
            ],
            "problemMatcher": []
        },
        {
            "label": "Build debug with CMake",
            "type": "shell",
            "dependsOn": [
                "Build Debug"
            ],
            "command": "echo",
            "args": [
                "Build Debug completed"
            ],
            "problemMatcher": []
        },

        // ========================================================================
        // Test Tasks (using CMake Presets)
        // ========================================================================
        {
            "label": "Test Debug",
            "type": "shell",
            "windows": {
                "command": "ctest",
                "args": [
                    "--preset",
                    "windows-msys-debug-test"
                ]
            },
            "linux": {
                "command": "ctest",
                "args": [
                    "--preset",
                    "linux-debug-test"
                ]
            },
            "osx": {
                "command": "ctest",
                "args": [
                    "--preset",
                    "macos-debug-test"
                ]
            },
            "dependsOn": [
                "Build Debug"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            }
        },
        {
            "label": "Test Release",
            "type": "shell",
            "windows": {
                "command": "ctest",
                "args": [
                    "--preset",
                    "windows-msys-release-test"
                ]
            },
            "linux": {
                "command": "ctest",
                "args": [
                    "--preset",
                    "linux-release-test"
                ]
            },
            "osx": {
                "command": "ctest",
                "args": [
                    "--preset",
                    "macos-release-test"
                ]
            },
            "dependsOn": [
                "Build Release"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            }
        },
        // ========================================================================
        // Analysis and Packaging Tasks
        // ========================================================================
        {
            "label": "Static Analysis (cppcheck)",
            "type": "shell",
            "windows": {
                "command": "bash",
                "args": [
                    "-c",
                    "cppcheck --enable=warning,performance,portability --inline-suppr --suppress=normalCheckLevelMaxBranches --template=gcc -I src -I include src 2> build/windows-debug/cppcheck-report.txt || true; if grep -E ':[0-9]+:[0-9]+: (error|warning):' build/windows-debug/cppcheck-report.txt >/dev/null; then cat build/windows-debug/cppcheck-report.txt; echo 'cppcheck issues found'; exit 1; else echo 'No blocking cppcheck issues'; fi"
                ]
            },
            "linux": {
                "command": "bash",
                "args": [
                    "-c",
                    "cppcheck --enable=warning,performance,portability --inline-suppr --suppress=normalCheckLevelMaxBranches --template=gcc -I src -I include src 2> build/linux-debug/cppcheck-report.txt || true; if grep -E ':[0-9]+:[0-9]+: (error|warning):' build/linux-debug/cppcheck-report.txt >/dev/null; then cat build/linux-debug/cppcheck-report.txt; echo 'cppcheck issues found'; exit 1; else echo 'No blocking cppcheck issues'; fi"
                ]
            },
            "osx": {
                "command": "bash",
                "args": [
                    "-c",
                    "cppcheck --enable=warning,performance,portability --inline-suppr --suppress=normalCheckLevelMaxBranches --template=gcc -I src -I include src 2> build/macos-debug/cppcheck-report.txt || true; if grep -E ':[0-9]+:[0-9]+: (error|warning):' build/macos-debug/cppcheck-report.txt >/dev/null; then cat build/macos-debug/cppcheck-report.txt; echo 'cppcheck issues found'; exit 1; else echo 'No blocking cppcheck issues'; fi"
                ]
            },
            "dependsOn": [
                "Configure Debug"
            ]
        },
        {
            "label": "Package Release",
            "type": "shell",
            "windows": {
                "command": "cpack",
                "args": [
                    "--preset",
                    "windows-msys-release-package"
                ]
            },
            "linux": {
                "command": "cpack",
                "args": [
                    "--preset",
                    "linux-release-package"
                ]
            },
            "osx": {
                "command": "cpack",
                "args": [
                    "--preset",
                    "macos-release-package"
                ]
            },
            "dependsOn": [
                "Build Release"
            ]
        },
        // ========================================================================
        // Run Tasks
        // ========================================================================
        {
            "label": "Run App (Debug)",
            "type": "shell",
            "linux": {
                "command": "bash",
                "args": [
                    "-c",
                    "exec build/linux-debug/src/LogViewer || exec build/linux-debug/LogViewer"
                ]
            },
            "osx": {
                "command": "bash",
                "args": [
                    "-c",
                    "APP=build/macos-debug/src/LogViewer; BUNDLE=build/macos-debug/src/LogViewer.app/Contents/MacOS/LogViewer; [ -x \"$BUNDLE\" ] && exec \"$BUNDLE\" || exec \"$APP\""
                ]
            },
            "windows": {
                "command": "cmd",
                "args": [
                    "/c",
                    "if exist build\\windows-debug\\src\\LogViewer.exe (build\\windows-debug\\src\\LogViewer.exe) else (build\\windows-debug\\LogViewer.exe)"
                ],
                "options": {
                    "env": {
                        "PATH": "C:\\msys64\\mingw64\\bin;%PATH%"
                    }
                }
            },
            "dependsOn": [
                "Build Debug"
            ],
            "isBackground": true
        },
        {
            "label": "Run Tests (Debug)",
            "type": "shell",
            "linux": {
                "command": "bash",
                "args": [
                    "-c",
                    "ctest --test-dir build/linux-debug --output-on-failure"
                ]
            },
            "osx": {
                "command": "bash",
                "args": [
                    "-c",
                    "ctest --test-dir build/macos-debug --output-on-failure"
                ]
            },
            "windows": {
                "command": "cmd",
                "args": [
                    "/c",
                    "ctest --test-dir build\\windows-debug --output-on-failure"
                ],
                "options": {
                    "env": {
                        "PATH": "C:\\msys64\\mingw64\\bin;%PATH%"
                    }
                }
            },
            "dependsOn": [
                "Build Debug"
            ]
        },
        // ========================================================================
        // Utility Tasks
        // ========================================================================
        {
            "label": "Clean",
            "type": "shell",
            "command": "bash",
            "args": [
                "-c",
                "rm -rf build dist compile_commands.json"
            ],
            "problemMatcher": []
        },
        {
            "label": "Clean Build Artifacts",
            "type": "shell",
            "windows": {
                "command": "bash",
                "args": [
                    "-c",
                    "rm -rf build/windows-debug build/windows-release"
                ]
            },
            "linux": {
                "command": "bash",
                "args": [
                    "-c",
                    "rm -rf build/linux-debug build/linux-release"
                ]
            },
            "osx": {
                "command": "bash",
                "args": [
                    "-c",
                    "rm -rf build/macos-debug build/macos-release"
                ]
            },
            "problemMatcher": []
        },

        // ========================================================================
        // Workflow Tasks (Complete Build + Test + Package)
        // ========================================================================
        {
            "label": "Full Debug Workflow",
            "type": "shell",
            "windows": {
                "command": "cmake",
                "args": [
                    "--workflow",
                    "--preset",
                    "windows-msys-debug-workflow"
                ]
            },
            "linux": {
                "command": "cmake",
                "args": [
                    "--workflow",
                    "--preset",
                    "linux-debug-workflow"
                ]
            },
            "osx": {
                "command": "cmake",
                "args": [
                    "--workflow",
                    "--preset",
                    "macos-debug-workflow"
                ]
            },
            "problemMatcher": [
                "$gcc"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            }
        },
        {
            "label": "Full Release Workflow",
            "type": "shell",
            "windows": {
                "command": "cmake",
                "args": [
                    "--workflow",
                    "--preset",
                    "windows-msys-release-workflow"
                ]
            },
            "linux": {
                "command": "cmake",
                "args": [
                    "--workflow",
                    "--preset",
                    "linux-release-workflow"
                ]
            },
            "osx": {
                "command": "cmake",
                "args": [
                    "--workflow",
                    "--preset",
                    "macos-release-workflow"
                ]
            },
            "problemMatcher": [
                "$gcc"
            ],
            "presentation": {
                "reveal": "always",
                "panel": "shared"
            }
        }
    ]
}